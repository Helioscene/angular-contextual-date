!function(){"use strict";angular.module("angular-contextual-date",[])}();
!function(){"use strict";function t(){var t={scope:{datetime:"=",timezone:"="},restrict:"EA",controller:e,controllerAs:"CDC",template:"<span ng-bind='CDC.cDateFormatted'></span>",bindToController:!0};return t}function e(t){function e(){n.cDateFormatted=t.format(n.datetime,null,n.timezone)}var n=this;n.cDateFormatted="",e()}angular.module("angular-contextual-date").directive("contextualDate",t),t.$inject=[],e.$inject=["contextualDateService"]}();
!function(){"use strict";function t(t){function n(n,e){return t.format(n,null,e)}return n}angular.module("angular-contextual-date").filter("contextualDate",t),t.$inject=["contextualDateService"]}();
!function(){"use strict";function e(e,t){function a(e,t,a){var n=u.parseDate(e);if(isNaN(n))return e;var r,o,s=new Date;if(o=u.formatRelative(n,s),u.config.hideFullDate)return o;r=t?t:u.formatFull(n,s,a);var i=u.config.contextualDateFormat,l=i.replace("%fullDate%",r).replace("%relativeDate%",o);return l}function n(t,a,n){var r=u.parseDate(t);if(isNaN(r))return t;a=a||new Date;var o="",s=u.config.thresholds,i=r.getDate()===a.getDate()&&r.getMonth()===a.getMonth()&&r.getFullYear()===a.getFullYear(),l=new Date(a.getTime());l.setDate(l.getDate()-Math.round(31*s.month));var m=r.getTime()-l.getTime()>=0,d=new Date(a.getTime());d.setDate(d.getDate()-Math.round(365*s.year));var c=r.getTime()-d.getTime()>=0,h=e("date"),g=u.config.fullDateFormats;return o=i?h(r,g.today,n):m?h(r,g.thisMonth,n):c?h(r,g.thisYear,n):h(r,g.historical,n)}function r(e){return Array.prototype.join.call(arguments," ").trim()}function o(){var e,a=u.config.language,n=t[0].documentElement.lang;return a&&(e=u.languages[a]),!e&&n&&(e=u.languages[n]),e||(e=u.languages.en_US),e}function s(e,t){var a=u.parseDate(e);if(isNaN(a))return e;t=t||new Date;var n=o(),s=t.getTime()-a.getTime(),i=s,l=i/1e3,m=l/60,d=m/60,c=d/24,h=c/7,g=c/30,f=c/365,D="",y=u.config.thresholds;return f>=y.years?D=r(Math.round(f),n.years):f>=y.year?D=r(1,n.year):g>=y.months?D=r(Math.round(g),n.months):g>=y.month?D=r(1,n.month):h>=y.weeks?D=r(Math.round(h),n.weeks):h>=y.week?D=r(1,n.week):c>=y.days?D=r(Math.round(c),n.days):c>=y.day?D=r(1,n.day):d>=y.hours?D=r(Math.round(d),n.hours):d>=y.hour?D=r(1,n.hour):m>=y.minutes?D=r(Math.round(m),n.minutes):m>=y.minute?D=r(1,n.minute):l>=y.seconds?D=r(Math.round(l),n.seconds):l>=y.second?D=r(1,n.second):i>=y.milliseconds?D=r(Math.round(i),n.milliseconds):i>=y.millisecond&&(D=r(1,n.millisecond)),D=D?r(n.prefix,D,n.suffix):n.now}function i(e){return e instanceof Date?e:new Date(angular.isNumber(e)?e:/^\d+$/.test(e)?parseInt(e,10):e)}var u={format:a,formatRelative:s,formatFull:n,parseDate:i,config:{hideFullDate:!1,fullDateFormats:{today:"h:mm a",thisMonth:"MMM d 'at' h:mm a",thisYear:"MMM d",historical:"MMM d, y"},contextualDateFormat:"%fullDate% (%relativeDate%)",language:null,thresholds:{years:1.75,year:.75,months:1.75,month:.9,weeks:1.75,week:1,days:2,day:1,hours:2,hour:1,minutes:2,minute:1,seconds:2,second:1,milliseconds:2,millisecond:1}},languages:{en_US:{now:"just now",prefix:"",suffix:"ago",millisecond:"millisecond",milliseconds:"milliseconds",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",week:"week",weeks:"weeks",month:"month",months:"months",year:"year",years:"years"}}};return u}angular.module("angular-contextual-date").factory("contextualDateService",e),e.$inject=["$filter","$document"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRleHR1YWwtZGF0ZS5tb2R1bGUuanMiLCJjb250ZXh0dWFsLWRhdGUuZGlyZWN0aXZlLmpzIiwiY29udGV4dHVhbC1kYXRlLmZpbHRlci5qcyIsImNvbnRleHR1YWwtZGF0ZS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250ZXh0dWFsRGF0ZURpcmVjdGl2ZSIsImRpcmVjdGl2ZSIsInNjb3BlIiwiZGF0ZXRpbWUiLCJ0aW1lem9uZSIsInJlc3RyaWN0IiwiY29udHJvbGxlciIsIkNvbnRleHR1YWxEYXRlQ29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlIiwiYmluZFRvQ29udHJvbGxlciIsImNvbnRleHR1YWxEYXRlU2VydmljZSIsImFjdGl2YXRlIiwidm0iLCJjRGF0ZUZvcm1hdHRlZCIsImZvcm1hdCIsInRoaXMiLCIkaW5qZWN0IiwiY29udGV4dHVhbERhdGVGaWx0ZXIiLCJmaWx0ZXIiLCJ2YWx1ZSIsIiRmaWx0ZXIiLCIkZG9jdW1lbnQiLCJkYXRlIiwiZnVsbERhdGVPdmVycmlkZSIsImxkYXRlIiwic2VydmljZSIsInBhcnNlRGF0ZSIsImlzTmFOIiwiZnVsbERhdGUiLCJyZWxhdGl2ZURhdGUiLCJub3ciLCJEYXRlIiwiZm9ybWF0UmVsYXRpdmUiLCJjb25maWciLCJoaWRlRnVsbERhdGUiLCJmb3JtYXRGdWxsIiwiZm9ybWF0dGVyIiwiY29udGV4dHVhbERhdGVGb3JtYXQiLCJyZXN1bHQiLCJyZXBsYWNlIiwidGhyZXNob2xkcyIsImlzVG9kYXkiLCJnZXREYXRlIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsInRoaXNNb250aCIsImdldFRpbWUiLCJzZXREYXRlIiwiTWF0aCIsInJvdW5kIiwibW9udGgiLCJpc1RoaXNNb250aCIsInRoaXNZZWFyIiwieWVhciIsImlzVGhpc1llYXIiLCIkZGF0ZUZpbHRlciIsImRhdGVGb3JtYXRzIiwiZnVsbERhdGVGb3JtYXRzIiwidG9kYXkiLCJoaXN0b3JpY2FsIiwicGFkIiwiYXJncyIsIkFycmF5IiwicHJvdG90eXBlIiwiam9pbiIsImNhbGwiLCJhcmd1bWVudHMiLCJ0cmltIiwiZ2V0TGFuZyIsImxhbmciLCJzbGFuZyIsImxhbmd1YWdlIiwiZGxhbmciLCJkb2N1bWVudEVsZW1lbnQiLCJsYW5ndWFnZXMiLCJlbl9VUyIsImRpZmYiLCJtaWxsaXNlY29uZHMiLCJzZWNvbmRzIiwibWludXRlcyIsImhvdXJzIiwiZGF5cyIsIndlZWtzIiwibW9udGhzIiwieWVhcnMiLCJyZWxhdGl2ZSIsInRoIiwid2VlayIsImRheSIsImhvdXIiLCJtaW51dGUiLCJzZWNvbmQiLCJtaWxsaXNlY29uZCIsInByZWZpeCIsInN1ZmZpeCIsImlucHV0IiwiaXNOdW1iZXIiLCJ0ZXN0IiwicGFyc2VJbnQiLCJmYWN0b3J5Il0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBRUFBLFNBQVFDLE9BQU87Q0NIZixXQUNBLFlBT0EsU0FBU0MsS0FDTCxHQUFJQyxJQUNBQyxPQUNJQyxTQUFVLElBQ1ZDLFNBQVUsS0FFZEMsU0FBVSxLQUNWQyxXQUFZQyxFQUNaQyxhQUFjLE1BQ2RDLFNBQVUsNkNBQ1ZDLGtCQUFrQixFQUd0QixPQUFPVCxHQUlYLFFBQVNNLEdBQTBCSSxHQVkvQixRQUFTQyxLQUNMQyxFQUFHQyxlQUFpQkgsRUFBc0JJLE9BQ3RDRixFQUFHVixTQUNILEtBQ0FVLEVBQUdULFVBZlgsR0FBSVMsR0FBS0csSUFPVEgsR0FBR0MsZUFBaUIsR0FFcEJGLElBaENKZCxRQUNLQyxPQUFPLDJCQUNQRSxVQUFVLGlCQUFrQkQsR0FFakNBLEVBQXdCaUIsV0FpQnhCVixFQUF5QlUsU0FBVztDQ3hCcEMsV0FDQSxZQVFBLFNBQVNDLEdBQXNCUCxHQUczQixRQUFTUSxHQUFRQyxFQUFPaEIsR0FDcEIsTUFBT08sR0FBc0JJLE9BQU9LLEVBQU8sS0FBTWhCLEdBSHJELE1BQU9lLEdBUFhyQixRQUNLQyxPQUFPLDJCQUNQb0IsT0FBTyxpQkFBa0JELEdBRTlCQSxF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S3ZDLElBUXhCLFFBQVNKLEdBQVdxRSxHQUNoQixNQUFJQSxhQUFpQmhFLE1BQ1ZnRSxFQUdBLEdBQUloRSxNQURKbEMsUUFBUW1HLFNBQVNELEdBQ1JBLEVBRVQsUUFBUUUsS0FBS0YsR0FDSkcsU0FBU0gsRUFBTyxJQUdoQkEsR0EvT3hCLEdBQUl0RSxJQUVBWCxPQUFRQSxFQUNSa0IsZUFBZ0JBLEVBQ2hCRyxXQUFZQSxFQUNaVCxVQUFXQSxFQUdYTyxRQUNJQyxjQUFlLEVBRWZ1QixpQkFDSUMsTUFBTyxTQUNQYixVQUFXLG9CQUNYTyxTQUFVLFFBQ1ZPLFdBQVksWUFHaEJ0QixxQkFBc0IsOEJBRXRCa0MsU0FBVSxLQUVWL0IsWUFDSTRDLE1BQU8sS0FDUC9CLEtBQU0sSUFDTjhCLE9BQVEsS0FDUmpDLE1BQU8sR0FDUGdDLE1BQU8sS0FDUEssS0FBTSxFQUNOTixLQUFNLEVBQ05PLElBQUssRUFDTFIsTUFBTyxFQUNQUyxLQUFNLEVBQ05WLFFBQVMsRUFDVFcsT0FBUSxFQUNSWixRQUFTLEVBQ1RhLE9BQVEsRUFDUmQsYUFBYyxFQUNkZSxZQUFhLElBS3JCbEIsV0FDSUMsT0FFSTdDLElBQUssV0FFTCtELE9BQVEsR0FDUkMsT0FBUSxNQUVSRixZQUFhLGNBQ2JmLGFBQWMsZUFDZGMsT0FBUSxTQUNSYixRQUFTLFVBQ1RZLE9BQVEsU0FDUlgsUUFBUyxVQUNUVSxLQUFNLE9BQ05ULE1BQU8sUUFDUFEsSUFBSyxNQUNMUCxLQUFNLE9BQ05NLEtBQU0sT0FDTkwsTUFBTyxRQUNQaEMsTUFBTyxRQUNQaUMsT0FBUSxTQUNSOUIsS0FBTSxPQUNOK0IsTUFBTyxVQUtuQixPQUFPM0QsR0E5RVg1QixRQUNLQyxPQUFPLDJCQUNQcUcsUUFBUSx3QkFBeUJ6RixHQUV0Q0EsRUFBc0JNLFNBQVcsVUFBVyIsImZpbGUiOiJhbmd1bGFyLWNvbnRleHR1YWwtZGF0ZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnYW5ndWxhci1jb250ZXh0dWFsLWRhdGUnLCBbXSk7XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdhbmd1bGFyLWNvbnRleHR1YWwtZGF0ZScpXHJcbiAgICAuZGlyZWN0aXZlKCdjb250ZXh0dWFsRGF0ZScsIGNvbnRleHR1YWxEYXRlRGlyZWN0aXZlKTtcclxuXHJcbmNvbnRleHR1YWxEYXRlRGlyZWN0aXZlLiRpbmplY3QgPSBbXTtcclxuZnVuY3Rpb24gY29udGV4dHVhbERhdGVEaXJlY3RpdmUgKCkge1xyXG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcclxuICAgICAgICBzY29wZSA6IHtcclxuICAgICAgICAgICAgZGF0ZXRpbWU6IFwiPVwiLFxyXG4gICAgICAgICAgICB0aW1lem9uZTogXCI9XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlc3RyaWN0OiBcIkVBXCIsXHJcbiAgICAgICAgY29udHJvbGxlcjogQ29udGV4dHVhbERhdGVDb250cm9sbGVyLFxyXG4gICAgICAgIGNvbnRyb2xsZXJBczogXCJDRENcIixcclxuICAgICAgICB0ZW1wbGF0ZTogXCI8c3BhbiBuZy1iaW5kPSdDREMuY0RhdGVGb3JtYXR0ZWQnPjwvc3Bhbj5cIixcclxuICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBkaXJlY3RpdmU7XHJcbn1cclxuXHJcbkNvbnRleHR1YWxEYXRlQ29udHJvbGxlci4kaW5qZWN0ID0gWydjb250ZXh0dWFsRGF0ZVNlcnZpY2UnXTtcclxuZnVuY3Rpb24gQ29udGV4dHVhbERhdGVDb250cm9sbGVyIChjb250ZXh0dWFsRGF0ZVNlcnZpY2UpIHtcclxuICAgIHZhciB2bSA9IHRoaXM7XHJcblxyXG4gICAgLy8gRGlyZWN0aXZlIHZhcmlhYmxlc1xyXG4gICAgLy8gdm0uZGF0ZXRpbWVcclxuICAgIC8vIHZtLnRpbWV6b25lXHJcblxyXG4gICAgLy8gTG9jYWwgdmFyaWFibGVzXHJcbiAgICB2bS5jRGF0ZUZvcm1hdHRlZCA9IFwiXCI7XHJcblxyXG4gICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSAoKSB7XHJcbiAgICAgICAgdm0uY0RhdGVGb3JtYXR0ZWQgPSBjb250ZXh0dWFsRGF0ZVNlcnZpY2UuZm9ybWF0KFxyXG4gICAgICAgICAgICB2bS5kYXRldGltZSxcclxuICAgICAgICAgICAgbnVsbCwgLyogb3ZlcnJpZGVEYXRlICovXHJcbiAgICAgICAgICAgIHZtLnRpbWV6b25lXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnYW5ndWxhci1jb250ZXh0dWFsLWRhdGUnKVxyXG4gICAgLmZpbHRlcignY29udGV4dHVhbERhdGUnLCBjb250ZXh0dWFsRGF0ZUZpbHRlcik7XHJcblxyXG5jb250ZXh0dWFsRGF0ZUZpbHRlci4kaW5qZWN0ID0gWydjb250ZXh0dWFsRGF0ZVNlcnZpY2UnXTtcclxuXHJcbmZ1bmN0aW9uIGNvbnRleHR1YWxEYXRlRmlsdGVyIChjb250ZXh0dWFsRGF0ZVNlcnZpY2UpIHtcclxuICAgIHJldHVybiBmaWx0ZXI7XHJcblxyXG4gICAgZnVuY3Rpb24gZmlsdGVyICh2YWx1ZSwgdGltZXpvbmUpIHtcclxuICAgICAgICByZXR1cm4gY29udGV4dHVhbERhdGVTZXJ2aWNlLmZvcm1hdCh2YWx1ZSwgbnVsbCwgdGltZXpvbmUpO1xyXG4gICAgfVxyXG59XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdhbmd1bGFyLWNvbnRleHR1YWwtZGF0ZScpXHJcbiAgICAuZmFjdG9yeSgnY29udGV4dHVhbERhdGVTZXJ2aWNlJywgY29udGV4dHVhbERhdGVTZXJ2aWNlKTtcclxuXHJcbmNvbnRleHR1YWxEYXRlU2VydmljZS4kaW5qZWN0ID0gW1wiJGZpbHRlclwiLCBcIiRkb2N1bWVudFwiXTtcclxuXHJcbmZ1bmN0aW9uIGNvbnRleHR1YWxEYXRlU2VydmljZSAoJGZpbHRlciwgJGRvY3VtZW50KSB7XHJcbiAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAvLyBmdW5jdGlvbnNcclxuICAgICAgICBmb3JtYXQ6IGZvcm1hdCxcclxuICAgICAgICBmb3JtYXRSZWxhdGl2ZTogZm9ybWF0UmVsYXRpdmUsXHJcbiAgICAgICAgZm9ybWF0RnVsbDogZm9ybWF0RnVsbCxcclxuICAgICAgICBwYXJzZURhdGU6IHBhcnNlRGF0ZSxcclxuXHJcbiAgICAgICAgLy8gY29uZmlndXJhdGlvbnNcclxuICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgaGlkZUZ1bGxEYXRlIDogZmFsc2UsXHJcblxyXG4gICAgICAgICAgICBmdWxsRGF0ZUZvcm1hdHMgOiB7XHJcbiAgICAgICAgICAgICAgICB0b2RheTogXCJoOm1tIGFcIixcclxuICAgICAgICAgICAgICAgIHRoaXNNb250aDogXCJNTU0gZCAnYXQnIGg6bW0gYVwiLFxyXG4gICAgICAgICAgICAgICAgdGhpc1llYXI6IFwiTU1NIGRcIixcclxuICAgICAgICAgICAgICAgIGhpc3RvcmljYWw6IFwiTU1NIGQsIHlcIlxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgY29udGV4dHVhbERhdGVGb3JtYXQ6IFwiJWZ1bGxEYXRlJSAoJXJlbGF0aXZlRGF0ZSUpXCIsXHJcblxyXG4gICAgICAgICAgICBsYW5ndWFnZTogbnVsbCwgLy8gdGhpcyB3aWxsIGhhcmQgc2V0IHRoZSBsYW5ndWFnZVxyXG5cclxuICAgICAgICAgICAgdGhyZXNob2xkczoge1xyXG4gICAgICAgICAgICAgICAgeWVhcnM6IDEuNzUsXHJcbiAgICAgICAgICAgICAgICB5ZWFyOiAwLjc1LFxyXG4gICAgICAgICAgICAgICAgbW9udGhzOiAxLjc1LFxyXG4gICAgICAgICAgICAgICAgbW9udGg6IDAuOSxcclxuICAgICAgICAgICAgICAgIHdlZWtzOiAxLjc1LFxyXG4gICAgICAgICAgICAgICAgd2VlazogMS4wLFxyXG4gICAgICAgICAgICAgICAgZGF5czogMi4wLFxyXG4gICAgICAgICAgICAgICAgZGF5OiAxLjAsXHJcbiAgICAgICAgICAgICAgICBob3VyczogMi4wLFxyXG4gICAgICAgICAgICAgICAgaG91cjogMS4wLFxyXG4gICAgICAgICAgICAgICAgbWludXRlczogMi4wLFxyXG4gICAgICAgICAgICAgICAgbWludXRlOiAxLjAsXHJcbiAgICAgICAgICAgICAgICBzZWNvbmRzOiAyLjAsXHJcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IDEuMCxcclxuICAgICAgICAgICAgICAgIG1pbGxpc2Vjb25kczogMi4wLFxyXG4gICAgICAgICAgICAgICAgbWlsbGlzZWNvbmQ6IDEuMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLy8gbGFuZ3VhZ2Ugc3VwcG9ydFxyXG4gICAgICAgIGxhbmd1YWdlcyA6IHtcclxuICAgICAgICAgICAgJ2VuX1VTJzoge1xyXG5cclxuICAgICAgICAgICAgICAgIG5vdzogXCJqdXN0IG5vd1wiLFxyXG5cclxuICAgICAgICAgICAgICAgIHByZWZpeDogXCJcIixcclxuICAgICAgICAgICAgICAgIHN1ZmZpeDogXCJhZ29cIixcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgbWlsbGlzZWNvbmQ6IFwibWlsbGlzZWNvbmRcIixcclxuICAgICAgICAgICAgICAgIG1pbGxpc2Vjb25kczogXCJtaWxsaXNlY29uZHNcIixcclxuICAgICAgICAgICAgICAgIHNlY29uZDogXCJzZWNvbmRcIixcclxuICAgICAgICAgICAgICAgIHNlY29uZHM6IFwic2Vjb25kc1wiLFxyXG4gICAgICAgICAgICAgICAgbWludXRlOiBcIm1pbnV0ZVwiLFxyXG4gICAgICAgICAgICAgICAgbWludXRlczogXCJtaW51dGVzXCIsXHJcbiAgICAgICAgICAgICAgICBob3VyOiBcImhvdXJcIixcclxuICAgICAgICAgICAgICAgIGhvdXJzOiBcImhvdXJzXCIsXHJcbiAgICAgICAgICAgICAgICBkYXk6IFwiZGF5XCIsXHJcbiAgICAgICAgICAgICAgICBkYXlzOiBcImRheXNcIixcclxuICAgICAgICAgICAgICAgIHdlZWs6IFwid2Vla1wiLFxyXG4gICAgICAgICAgICAgICAgd2Vla3M6IFwid2Vla3NcIixcclxuICAgICAgICAgICAgICAgIG1vbnRoOiBcIm1vbnRoXCIsXHJcbiAgICAgICAgICAgICAgICBtb250aHM6IFwibW9udGhzXCIsXHJcbiAgICAgICAgICAgICAgICB5ZWFyOiBcInllYXJcIixcclxuICAgICAgICAgICAgICAgIHllYXJzOiBcInllYXJzXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgZnVuY3Rpb24gZm9ybWF0IChkYXRlLCBmdWxsRGF0ZU92ZXJyaWRlLCB0aW1lem9uZSkge1xyXG4gICAgICAgIHZhciBsZGF0ZSA9IHNlcnZpY2UucGFyc2VEYXRlKGRhdGUpO1xyXG5cclxuICAgICAgICAvLyBXZSB3ZXJlbid0IGFibGUgdG8gcGFyc2UgdGhlIGRhdGUsIGp1c3QgcmV0dXJuIGFzIGlzXHJcbiAgICAgICAgaWYgKGlzTmFOKGxkYXRlKSkgeyByZXR1cm4gZGF0ZTsgfVxyXG5cclxuICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKTtcclxuICAgICAgICB2YXIgZnVsbERhdGUsIHJlbGF0aXZlRGF0ZTtcclxuXHJcbiAgICAgICAgcmVsYXRpdmVEYXRlID0gc2VydmljZS5mb3JtYXRSZWxhdGl2ZShsZGF0ZSwgbm93KTtcclxuXHJcbiAgICAgICAgaWYgKHNlcnZpY2UuY29uZmlnLmhpZGVGdWxsRGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVsYXRpdmVEYXRlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGZ1bGxEYXRlT3ZlcnJpZGUpIHtcclxuICAgICAgICAgICAgZnVsbERhdGUgPSBmdWxsRGF0ZU92ZXJyaWRlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZ1bGxEYXRlID0gc2VydmljZS5mb3JtYXRGdWxsKGxkYXRlLCBub3csIHRpbWV6b25lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBmb3JtYXR0ZXIgPSBzZXJ2aWNlLmNvbmZpZy5jb250ZXh0dWFsRGF0ZUZvcm1hdDtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gZm9ybWF0dGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJWZ1bGxEYXRlJScsIGZ1bGxEYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyVyZWxhdGl2ZURhdGUlJywgcmVsYXRpdmVEYXRlKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBmb3JtYXRGdWxsKGRhdGUsIG5vdywgdGltZXpvbmUpIHtcclxuICAgICAgICB2YXIgbGRhdGUgPSBzZXJ2aWNlLnBhcnNlRGF0ZShkYXRlKTtcclxuICAgICAgICBpZiAoaXNOYU4obGRhdGUpKSB7IHJldHVybiBkYXRlOyB9XHJcblxyXG4gICAgICAgIG5vdyA9IG5vdyB8fCBuZXcgRGF0ZSgpO1xyXG5cclxuICAgICAgICB2YXIgZnVsbERhdGUgPSBcIlwiO1xyXG4gICAgICAgIHZhciB0aHJlc2hvbGRzID0gc2VydmljZS5jb25maWcudGhyZXNob2xkcztcclxuXHJcbiAgICAgICAgdmFyIGlzVG9kYXkgPSAobGRhdGUuZ2V0RGF0ZSgpID09PSBub3cuZ2V0RGF0ZSgpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZGF0ZS5nZXRNb250aCgpID09PSBub3cuZ2V0TW9udGgoKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGRhdGUuZ2V0RnVsbFllYXIoKSA9PT0gbm93LmdldEZ1bGxZZWFyKCkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciB0aGlzTW9udGggPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpKTtcclxuICAgICAgICB0aGlzTW9udGguc2V0RGF0ZSh0aGlzTW9udGguZ2V0RGF0ZSgpIC0gTWF0aC5yb3VuZCh0aHJlc2hvbGRzLm1vbnRoICogMzEpKTtcclxuICAgICAgICB2YXIgaXNUaGlzTW9udGggPSAobGRhdGUuZ2V0VGltZSgpIC0gdGhpc01vbnRoLmdldFRpbWUoKSA+PSAwKTtcclxuXHJcbiAgICAgICAgdmFyIHRoaXNZZWFyID0gbmV3IERhdGUobm93LmdldFRpbWUoKSk7XHJcbiAgICAgICAgdGhpc1llYXIuc2V0RGF0ZSh0aGlzWWVhci5nZXREYXRlKCkgLSBNYXRoLnJvdW5kKHRocmVzaG9sZHMueWVhciAqIDM2NSkpO1xyXG4gICAgICAgIHZhciBpc1RoaXNZZWFyID0gKGxkYXRlLmdldFRpbWUoKSAtIHRoaXNZZWFyLmdldFRpbWUoKSA+PSAwKTtcclxuXHJcbiAgICAgICAgdmFyICRkYXRlRmlsdGVyID0gJGZpbHRlcignZGF0ZScpO1xyXG4gICAgICAgIHZhciBkYXRlRm9ybWF0cyA9IHNlcnZpY2UuY29uZmlnLmZ1bGxEYXRlRm9ybWF0cztcclxuXHJcbiAgICAgICAgaWYgKGlzVG9kYXkpIHtcclxuICAgICAgICAgICAgZnVsbERhdGUgPSAkZGF0ZUZpbHRlcihsZGF0ZSwgZGF0ZUZvcm1hdHMudG9kYXksIHRpbWV6b25lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaXNUaGlzTW9udGgpIHtcclxuICAgICAgICAgICAgZnVsbERhdGUgPSAkZGF0ZUZpbHRlcihsZGF0ZSwgZGF0ZUZvcm1hdHMudGhpc01vbnRoLCB0aW1lem9uZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGlzVGhpc1llYXIpIHtcclxuICAgICAgICAgICAgZnVsbERhdGUgPSAkZGF0ZUZpbHRlcihsZGF0ZSwgZGF0ZUZvcm1hdHMudGhpc1llYXIsIHRpbWV6b25lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZ1bGxEYXRlID0gJGRhdGVGaWx0ZXIobGRhdGUsIGRhdGVGb3JtYXRzLmhpc3RvcmljYWwsIHRpbWV6b25lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmdWxsRGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwYWQoYXJncykge1xyXG4gICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuam9pbi5jYWxsKGFyZ3VtZW50cywgXCIgXCIpLnRyaW0oKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRMYW5nKCkge1xyXG4gICAgICAgIHZhciBzbGFuZyA9IHNlcnZpY2UuY29uZmlnLmxhbmd1YWdlO1xyXG4gICAgICAgIHZhciBkbGFuZyA9ICRkb2N1bWVudFswXS5kb2N1bWVudEVsZW1lbnQubGFuZztcclxuICAgICAgICB2YXIgbGFuZztcclxuXHJcbiAgICAgICAgaWYgKHNsYW5nKSB7XHJcbiAgICAgICAgICAgIGxhbmcgPSBzZXJ2aWNlLmxhbmd1YWdlc1tzbGFuZ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbGFuZyAmJiBkbGFuZykge1xyXG4gICAgICAgICAgICBsYW5nID0gc2VydmljZS5sYW5ndWFnZXNbZGxhbmddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWxhbmcpIHtcclxuICAgICAgICAgICAgbGFuZyA9IHNlcnZpY2UubGFuZ3VhZ2VzLmVuX1VTO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGxhbmc7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZm9ybWF0UmVsYXRpdmUoZGF0ZSwgbm93KSB7XHJcbiAgICAgICAgdmFyIGxkYXRlID0gc2VydmljZS5wYXJzZURhdGUoZGF0ZSk7XHJcbiAgICAgICAgaWYgKGlzTmFOKGxkYXRlKSkgeyByZXR1cm4gZGF0ZTsgfVxyXG4gICAgICAgIG5vdyA9IG5vdyB8fCBuZXcgRGF0ZSgpO1xyXG5cclxuICAgICAgICB2YXIgbGFuZyA9IGdldExhbmcoKTtcclxuICAgICAgICB2YXIgZGlmZiA9IG5vdy5nZXRUaW1lKCkgLSBsZGF0ZS5nZXRUaW1lKCk7XHJcblxyXG4gICAgICAgIHZhciBtaWxsaXNlY29uZHMgPSBkaWZmO1xyXG4gICAgICAgIHZhciBzZWNvbmRzID0gbWlsbGlzZWNvbmRzIC8gMTAwMDtcclxuICAgICAgICB2YXIgbWludXRlcyA9IHNlY29uZHMgLyA2MDtcclxuICAgICAgICB2YXIgaG91cnMgPSBtaW51dGVzIC8gNjA7XHJcbiAgICAgICAgdmFyIGRheXMgPSBob3VycyAvIDI0O1xyXG4gICAgICAgIHZhciB3ZWVrcyA9IGRheXMgLyA3O1xyXG4gICAgICAgIHZhciBtb250aHMgPSBkYXlzIC8gMzA7XHJcbiAgICAgICAgdmFyIHllYXJzID0gZGF5cyAvIDM2NTtcclxuXHJcbiAgICAgICAgdmFyIHJlbGF0aXZlID0gXCJcIjtcclxuXHJcbiAgICAgICAgdmFyIHRoID0gc2VydmljZS5jb25maWcudGhyZXNob2xkcztcclxuXHJcbiAgICAgICAgaWYgKHllYXJzID49IHRoLnllYXJzKSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKE1hdGgucm91bmQoeWVhcnMpLCBsYW5nLnllYXJzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHllYXJzID49IHRoLnllYXIpIHtcclxuICAgICAgICAgICAgcmVsYXRpdmUgPSBwYWQoMSwgbGFuZy55ZWFyKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG1vbnRocyA+PSB0aC5tb250aHMpIHtcclxuICAgICAgICAgICAgcmVsYXRpdmUgPSBwYWQoTWF0aC5yb3VuZChtb250aHMpLCBsYW5nLm1vbnRocyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChtb250aHMgPj0gdGgubW9udGgpIHtcclxuICAgICAgICAgICAgcmVsYXRpdmUgPSBwYWQoMSwgbGFuZy5tb250aCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3ZWVrcyA+PSB0aC53ZWVrcykge1xyXG4gICAgICAgICAgICByZWxhdGl2ZSA9IHBhZChNYXRoLnJvdW5kKHdlZWtzKSwgbGFuZy53ZWVrcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3ZWVrcyA+PSB0aC53ZWVrKSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKDEsIGxhbmcud2Vlayk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkYXlzID49IHRoLmRheXMpIHtcclxuICAgICAgICAgICAgcmVsYXRpdmUgPSBwYWQoTWF0aC5yb3VuZChkYXlzKSwgbGFuZy5kYXlzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGRheXMgPj0gdGguZGF5KSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKDEsIGxhbmcuZGF5KTtcclxuICAgICAgICB9IGVsc2UgaWYgKGhvdXJzID49IHRoLmhvdXJzKSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKE1hdGgucm91bmQoaG91cnMpLCBsYW5nLmhvdXJzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGhvdXJzID49IHRoLmhvdXIpIHtcclxuICAgICAgICAgICAgcmVsYXRpdmUgPSBwYWQoMSwgbGFuZy5ob3VyKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG1pbnV0ZXMgPj0gdGgubWludXRlcykge1xyXG4gICAgICAgICAgICByZWxhdGl2ZSA9IHBhZChNYXRoLnJvdW5kKG1pbnV0ZXMpLCBsYW5nLm1pbnV0ZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobWludXRlcyA+PSB0aC5taW51dGUpIHtcclxuICAgICAgICAgICAgcmVsYXRpdmUgPSBwYWQoMSwgbGFuZy5taW51dGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2Vjb25kcyA+PSB0aC5zZWNvbmRzKSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKE1hdGgucm91bmQoc2Vjb25kcyksIGxhbmcuc2Vjb25kcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzZWNvbmRzID49IHRoLnNlY29uZCkge1xyXG4gICAgICAgICAgICByZWxhdGl2ZSA9IHBhZCgxLCBsYW5nLnNlY29uZCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChtaWxsaXNlY29uZHMgPj0gdGgubWlsbGlzZWNvbmRzKSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKE1hdGgucm91bmQobWlsbGlzZWNvbmRzKSwgbGFuZy5taWxsaXNlY29uZHMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobWlsbGlzZWNvbmRzID49IHRoLm1pbGxpc2Vjb25kKSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKDEsIGxhbmcubWlsbGlzZWNvbmQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFyZWxhdGl2ZSkge1xyXG4gICAgICAgICAgICByZWxhdGl2ZSA9IGxhbmcubm93O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlbGF0aXZlID0gcGFkKGxhbmcucHJlZml4LCByZWxhdGl2ZSwgbGFuZy5zdWZmaXgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlbGF0aXZlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHBhcnNlRGF0ZSAoaW5wdXQpIHtcclxuICAgICAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICAvLyBkYXRlLmdldFRpbWUoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuaXNOdW1iZXIoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShpbnB1dCk7XHJcbiAgICAgICAgLy8gZGF0ZS5nZXRUaW1lKCk7IGFzIHN0cmluZ1xyXG4gICAgICAgIH0gZWxzZSBpZiAoL15cXGQrJC8udGVzdChpbnB1dCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHBhcnNlSW50KGlucHV0LCAxMCkpO1xyXG4gICAgICAgIC8vIElTTyAvIFVUQ1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShpbnB1dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG59KSgpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=